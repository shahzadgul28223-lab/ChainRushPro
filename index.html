w<!DOCTYPE html>
<html lang="ur" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ChainRush Pro - Level System</title>
    <style>
        body { font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif; background: #f4f7f6; padding: 20px; text-align: center; }
        .container { max-width: 600px; margin: auto; background: white; padding: 20px; border-radius: 15px; box-shadow: 0 4px 15px rgba(0,0,0,0.1); }
        .plan-card { border: 1px solid #ddd; margin: 10px 0; padding: 15px; border-radius: 10px; display: flex; justify-content: space-between; align-items: center; background: #fff; transition: 0.3s; }
        .plan-card.locked { background: #f9f9f9; opacity: 0.7; }
        .plan-card.active { border-color: #2ecc71; background: #e8f8f0; }
        .btn { padding: 8px 15px; border: none; border-radius: 5px; cursor: pointer; font-weight: bold; }
        .btn-buy { background: #3498db; color: white; }
        .btn-locked { background: #95a5a6; color: white; cursor: not-allowed; }
        .btn-owned { background: #2ecc71; color: white; cursor: default; }
        .admin-box { background: #34495e; color: white; padding: 15px; border-radius: 10px; margin-bottom: 20px; }
        input { padding: 8px; border-radius: 5px; border: 1px solid #ddd; margin: 5px; }
    </style>
</head>
<body>

<div class="container">
    <div class="admin-box" id="adminArea">
        <h3>ایڈمن پینل</h3>
        <input type="text" id="targetUserId" placeholder="یوزر ID لکھیں">
        <select id="planToGive">
            <option value="1">پلان 1</option><option value="2">پلان 2</option>
            <option value="3">پلان 3</option><option value="4">پلان 4</option>
            <option value="5">پلان 5</option><option value="6">پلان 6</option>
            <option value="7">پلان 7</option><option value="8">پلان 8</option>
            <option value="9">پلان 9</option><option value="10">پلان 10</option>
            <option value="11">پلان 11</option><option value="12">پلان 12</option>
        </select>
        <button class="btn btn-buy" onclick="adminAssignPlan()">پلان دیں</button>
    </div>

    <h2>خوش آمدید <span id="userNameDisplay">یوزر</span></h2>
    <p>آپ کا موجودہ لیول: <strong id="currentLevelDisplay">0</strong></p>
    <hr>

    <div id="plansList"></div>
</div>

<script type="module">
    import { initializeApp } from "https://www.gstatic.com/firebasejs/10.7.1/firebase-app.js";
    import { getDatabase, ref, set, onValue, update } from "https://www.gstatic.com/firebasejs/10.7.1/firebase-database.js";

    const firebaseConfig = {
        apiKey: "AIzaSyDxzfp_f2Y0tStBsYNLx9xjWb6EgXFnXqg",
        authDomain: "chainrushpro.firebaseapp.com",
        databaseURL: "https://chainrushpro-default-rtdb.firebaseio.com",
        projectId: "chainrushpro",
        storageBucket: "chainrushpro.firebasestorage.app",
        messagingSenderId: "475042665109",
        appId: "1:475042665109:web:c1b6f59d3bde82b449c19c",
        measurementId: "G-D7B9HX12BB"
    };

    const app = initializeApp(firebaseConfig);
    const db = getDatabase(app);

    // فرضی یوزر ID (یہاں یوزر کی اپنی ID آئے گی)
    const myUserId = "1001"; 
    const isAdmin = true; // اگر آپ ایڈمن ہیں تو اسے true رکھیں

    // ایڈمن فنکشن: یوزر کو پلان دینا
    window.adminAssignPlan = function() {
        const uId = document.getElementById('targetUserId').value;
        const pNum = parseInt(document.getElementById('planToGive').value);
        if(uId) {
            update(ref(db, 'users/' + uId), { level: pNum });
            alert("یوزر " + uId + " کو پلان " + pNum + " دے دیا گیا ہے۔");
        }
    };

    // ڈیٹا لوڈ کرنا
    onValue(ref(db, 'users/' + myUserId), (snapshot) => {
        const data = snapshot.val();
        const userLevel = data ? data.level : 0;
        renderPlans(userLevel);
        document.getElementById('currentLevelDisplay').innerText = isAdmin ? "FULL (Admin)" : userLevel;
    });

    function renderPlans(currentLevel) {
        const listDiv = document.getElementById('plansList');
        listDiv.innerHTML = "";

        for (let i = 1; i <= 12; i++) {
            let status = "";
            let btnHtml = "";

            if (isAdmin || i <= currentLevel) {
                // اگر ایڈمن ہے یا یوزر خرید چکا ہے
                status = "active";
                btnHtml = `<button class="btn btn-owned">انلاک ہے</button>`;
            } else if (i === currentLevel + 1) {
                // اگلا والا پلان جو خریدا جا سکتا ہے
                status = "";
                btnHtml = `<button class="btn btn-buy" onclick="buyPlan(${i})">خریدیں</button>`;
            } else {
                // وہ پلان جو ابھی لاک ہیں (ترتیب کی وجہ سے)
                status = "locked";
                btnHtml = `<button class="btn btn-locked">پہلے پلان ${i-1} لیں</button>`;
            }

            listDiv.innerHTML += `
                <div class="plan-card ${status}">
                    <span>پلان نمبر ${i}</span>
                    ${btnHtml}
                </div>
            `;
        }
    }

    window.buyPlan = function(planNum) {
        if(confirm("کیا آپ پلان " + planNum + " خریدنا چاہتے ہیں؟")) {
            update(ref(db, 'users/' + myUserId), { level: planNum });
        }
    };
</script>

</body>
</html>
