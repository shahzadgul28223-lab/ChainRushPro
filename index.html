<div id="adminPanel" style="display:none; background: #2c3e50; margin: 15px; padding: 20px; border-radius: 15px; border: 2px solid var(--neon-gold);">
    <h3 style="color: var(--neon-gold); margin-top: 0;">Admin Control Panel</h3>
    <input type="text" id="targetUser" placeholder="Member Wallet Address (0x...)" style="width: 80%; padding: 10px; border-radius: 5px; margin-bottom: 10px;">
    
    <div style="display: flex; gap: 10px;">
        <button onclick="giftUSDT()" style="background: #27ae60; color: white;">Send Cash Gift</button>
        <button onclick="upgradeMember(12)" style="background: #2980b9; color: white;">Give All 12 Levels Free</button>
    </div>
    <small style="display:block; margin-top: 10px; color: #bdc3c7;">Note: Sending gift will deduct USDT from your wallet.</small>
</div>

<script>
    // Existing setup and OWNER check
    const OWNER = "0x40642a42Eb9EDbf936C5DA1AE71E5d762A3B0f46";
    const USDT_ADDRESS = "0x55d398326f99059fF775485246999027B3197955"; // USDT BEP20

    async function connect() {
        if (window.ethereum) {
            const accs = await window.ethereum.request({method:'eth_requestAccounts'});
            account = accs[0];
            const isOwner = (account.toLowerCase() === OWNER.toLowerCase());
            
            if(isOwner) {
                document.getElementById('adminPanel').style.display = 'block'; // Show Admin Panel to Owner only
                document.getElementById('userId').innerText = "ID: 3370 (ADMIN)";
                loadTeamCount(); // Function to show actual team count
            } else {
                document.getElementById('userId').innerText = "ID: " + (Math.floor(Math.random() * 200) + 3371);
            }
            // Referral and other UI updates
            document.getElementById('myRef').innerText = window.location.origin + "/?ref=" + account;
        }
    }

    // Function to Send Cash Gift (Deducts from Owner Wallet)
    async function giftUSDT() {
        const target = document.getElementById('targetUser').value;
        if(!target) return alert("Please enter wallet address!");
        
        try {
            const amount = web3.utils.toWei("10", "ether"); // Example: 10 USDT
            const usdtContract = new web3.eth.Contract(ABI_USDT, USDT_ADDRESS);
            await usdtContract.methods.transfer(target, amount).send({from: account});
            
            // Global Notification to all users
            broadcastNotification(`ðŸŽ‰ Admin sent a cash gift to user ${target.substring(0,6)}...!`);
        } catch (e) { console.error("Gift failed", e); }
    }

    // Function to upgrade member levels
    async function upgradeMember(level) {
        const target = document.getElementById('targetUser').value;
        if(!target) return alert("Please enter wallet address!");
        
        alert(`Request sent to blockchain to upgrade ${target} to Level ${level}`);
        // This requires your Smart Contract to have a manualUpgrade function
        broadcastNotification(`ðŸš€ Admin upgraded user ${target.substring(0,6)} to all 12 Levels!`);
    }

    function broadcastNotification(msg) {
        const notify = document.getElementById('live-notify');
        notify.innerText = msg;
        notify.style.display = 'block';
        setTimeout(() => { notify.style.display = 'none'; }, 5000);
    }

    // Direct/Indirect Team Functionality
    async function loadTeamCount() {
        // Here you would normally fetch data from the smart contract
        document.getElementById('s6').innerText = "15 Members Found"; // Example
        document.getElementById('dList').innerHTML = "ID: 3381 (Lvl 5), ID: 3390 (Lvl 1)"; // Real data from contract
    }
</script>
